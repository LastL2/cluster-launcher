resource "kubectl_manifest" "timescaledb_secrets" {
  yaml_body = <<YAML
apiVersion: v1
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVxRENDQXBBQ0NRQ3FRNFRxMkVVUCtEQU5CZ2txaGtpRzl3MEJBUXNGQURBV01SUXdFZ1lEVlFRRERBdDAKYVcxbGMyTmhiR1ZrWWpBZUZ3MHlNREExTWpJeU16QTVNakphRncweU1EQTFNak15TXpBNU1qSmFNQll4RkRBUwpCZ05WQkFNTUMzUnBiV1Z6WTJGc1pXUmlNSUlDSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQWc4QU1JSUNDZ0tDCkFnRUFzMDdxUXorZ2JodnExcnpaVTRXeEhlQlZvbld4ZTFsVzl6UmZKbDFZZldFNnljTjdyWjVHbUU0WVY2elEKU011WnR0NXJ3SWVtaytGZTZUOFpCTWo0Qm16MXNBTjE5NkREd29OaWNGeHRrRkNZRkJMa0tDT1F1cVpJV3B3KwpKdExsOG5kcEgyYjViL2tjdDFCODJJMWJsLy81bjZTanArVG5GT08veCtkL2oxeVdyREprUU9ycERRS09aV2NYCjg2aEY2ZWcrTlZuNlNPalE0LzM3Q21PeGZSdFIwNUx3ajNPMm1Ld0JPcWlUZXplVkVUaUxhWjFIbVAzbkQ2K04KYWplUUYzUTZYOFJ5RmNxbDJ3ejJvM0p0QTVSVEVRK2s1cXcwdHFlbmwvQ0dWMGpjanlsUStCR3Nzckw2eGxVQgpmQWcrRlM2a3FyTjhwcUlwOGdCYUppcDhoTFlTWlhLR0dkNWQ0ZHVTRzlZUFgwNnkzS3FLeDFuME5SY0xrYVB6Ci9GYUt5VGkvaSs0eWJ1aGJBMHFkcnI2OTlXSnhpN05zRVZMUXdCM0E0SmxOVCsvQ2QvRU4yWENpT2Y2QXhHK04KTWtGOTNKSFBrdFRMTTZxQmp0YWs5UnlPWDZOTWhnc1F3OTBWa044cHdhblJ5STlNZEZtN0hPVnBNb1BiOEJ2NApqL2RUV1BYajZ6QW1EZm02cDIwVlIxUkE5OFEvQnVldU1XQTJoZHZDMHl4aWJmMWh0ZnQ5N0R5SzFBNEJaYkZ1CnRhYVA4eUloRmJqb2NTMHRIL3FvZFZZMy9yZENoczFwc1gyd080OXBkWm1iSmxraEswbitjamhzMGdTK0VMbzQKNW4yOHl4eUM2ZHYyVjVxSHVqN1IzOGlKQm9lRWwzTnREaEpOZXhMN1plZWx5THNDQXdFQUFUQU5CZ2txaGtpRwo5dzBCQVFzRkFBT0NBZ0VBbWZlLzFRZUExeXltMGRaUkpnQ3BjSWE3SE8vWlowV3dqbHRpSExrNS84c0hYdXYxCmJvOUo4WnhycmFqd3phQ1lLQWl6bEN1R1Ywd2JrS2g2V0Z1N2Q1VzRnNjN2RzdFMFk0dHdtazFvMHdnM0NiVkQKNWF3SHFWMDVBWThvc1BERWFFMDJBUGsrd1NYZE1TODdCbENDeXNFQVpXUG1aSWJGbWtzeU1qZU1xdGgweXRiaAo2cmJNeSs4UjJlMkVzeE4vNEdVZE4wRGhScVJTdFpwTkRFRnRjb2FTWlVVZGJibU5mL0MxVjQwVnlBRzNhU0NVCjNGb0kwRU5wV3RuTW5LNk5pMGE5RXFySDFmVlFqSE5JVW9LNlh4cU1STThBVmFpTHpuWHJ3Y1B2WFhLeGpNdVgKSjB6ZmtIYTUvdk9oem9PUmdKV3NvWjcyOGxDRnRtTTZVb0Z1bWZWeERqMWlxM3JpdktTSmV3bng5QjIwdEpXQgpxSkgzc2tVeVFEQlBlTkxsL2dhSG55YXdBSWIwWUFyUkkxK202R1RITDRVS1UrSkU4TmM0dTFNSWJ5NllWRGduCkxnZjBneGVhRlNiampCMlIrL0VTMVNzRmhBYUlxOTByaUNvQXNxNUpHZHJvQnhvTVpRditrS1Z3OExWYlkwZEgKMnZ6WkNiRWU3aXF5SFhXN3RNeUtMeVVSeDVYVC96Zm5kcHZ3Z2dTMlpWdC9mMlB2UE9DbTBmTlJHRk9iVVVGOAppOG1EdDZLdlk4OW5LaW9mWnRnQUR5cU91OGlwQmZ3K3QrTXArVU1CMWpOcFd5QTJIaURlZkdLZWdSSHVUL2p2ClRJTHp1Sk9vS01PakdUdUU1T0syZDYvS0RSQnM3T3RLQThEd1JMckNkaEFBUWhCR2NoSUQ0L0syQ1FBPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpRd0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1Mwd2dna3BBZ0VBQW9JQ0FRQ3pUdXBEUDZCdUcrclcKdk5sVGhiRWQ0RldpZGJGN1dWYjNORjhtWFZoOVlUckp3M3V0bmthWVRoaFhyTkJJeTVtMjNtdkFoNmFUNFY3cApQeGtFeVBnR2JQV3dBM1gzb01QQ2cySndYRzJRVUpnVUV1UW9JNUM2cGtoYW5ENG0wdVh5ZDJrZlp2bHYrUnkzClVIellqVnVYLy9tZnBLT241T2NVNDcvSDUzK1BYSmFzTW1SQTZ1a05BbzVsWnhmenFFWHA2RDQxV2ZwSTZORGoKL2ZzS1k3RjlHMUhUa3ZDUGM3YVlyQUU2cUpON041VVJPSXRwblVlWS9lY1ByNDFxTjVBWGREcGZ4SElWeXFYYgpEUGFqY20wRGxGTVJENlRtckRTMnA2ZVg4SVpYU055UEtWRDRFYXl5c3ZyR1ZRRjhDRDRWTHFTcXMzeW1vaW55CkFGb21LbnlFdGhKbGNvWVozbDNoMjVJYjFnOWZUckxjcW9ySFdmUTFGd3VSby9QOFZvckpPTCtMN2pKdTZGc0QKU3AydXZyMzFZbkdMczJ3UlV0REFIY0RnbVUxUDc4SjM4UTNaY0tJNS9vREViNDB5UVgzY2tjK1MxTXN6cW9HTwoxcVQxSEk1Zm8weUdDeEREM1JXUTN5bkJxZEhJajB4MFdic2M1V2t5Zzl2d0cvaVA5MU5ZOWVQck1DWU4rYnFuCmJSVkhWRUQzeEQ4RzU2NHhZRGFGMjhMVExHSnQvV0cxKzMzc1BJclVEZ0Zsc1c2MXBvL3pJaUVWdU9oeExTMGYKK3FoMVZqZit0MEtHeldteGZiQTdqMmwxbVpzbVdTRXJTZjV5T0d6U0JMNFF1amptZmJ6TEhJTHAyL1pYbW9lNgpQdEhmeUlrR2g0U1hjMjBPRWsxN0V2dGw1NlhJdXdJREFRQUJBb0lDQVFDQzNoM3Nad3ZZVVZmYzBvaHJoUy8zCjlqdUtEd3d5VXNvK01tTWZ4UkZJc1NZUEREWEFTYnlNZkxNWGluR2FMNzlJMEowa0w5MU1JVGo4VTZrVzdQYlkKK2IxM2NZOHY1STM3OFpodkdZWjl4ZFM1RWZDanV4RnVxTjQyQThMNDR3UWhLelgyVFZuUWQ2aVZ3cERjSEkrMQpLSVl3RmlHNzhEMFg2Z0dYRFViMGcwY1U5dEprN3c2WkNEeVZsZUROWFF0cDVLOUNrU0V6Qlhrd2JiWkRwdTlyCnQvekl4bjM4dFIrWDNqSW5kZEh1SkdzUDNvMGgwRURwVUtiTHMvMHFnTk1SeXlxdnF0ajVQcVkrY2YrdzIxcmwKT2VSR2wzeHJQMVJaMjVOZU9aWlRMa0tMMmtQV1NsQVpQTGY2K1IvVVBzL1E5ZklKQkdiOTEyMTF5dndBenhHQgpNZmltRmt5R1J6eEJ6emJ3OXZhb1lnRWlsdXFoaVdvSFJyQmFzclFlRE1weDVIY3lnNEUvaVBCQ1J2cXRNaDhFCnk2Y3BubGQ4TG1hbzh2cE4vNEs4bkN2M2UzWVpJQ2VMd2R5NWZVRG9pdHY4TUpMZVFXemJzK0FqR0E2bVJlQmMKMmY3Z3RFNzFVSGZXL3NKcVJzM25vNEhDMlFWblp5L3M2akkvNVhMNk0zd3pFYnFvKzUzaUlTaEQvbXVVeE1NeQpqQ1VLVFFjMTNDdk9CTlpmN0kvblZkRndJUWxkSC9jTW1VdWNoZzRQUFd0TzdMWGZPcWgxNHQrdkpYWmV2eW1pClM2MEJNWHZNNTI4NmFYWktHRHlpWnBPUmNLVnBzRW4zTGZDSzFvaUdGeUJUMi94VmMzalVpSUlWd2c4Z2ZTVEkKejF0MEQxWWo0MVZHWVowdm4rVHR3UUtDQVFFQTJja2dwbWxkRDNoeElRUEF3NjRJQUJaWm5rek1xa1RRTjV1WApwdnMrdXRVL29qTGJkb1lVR2hrT2F1R3I4VkVjY25XUGtwNjlYNHowaHFCODZJY29maGtBdThBcnVGamdXS1R2CmRnWk1FMm9oTHh5S0ZodWNJWlBjYWdWY2JGWEJrUWlRTHM3MDJIUysxMnI1c1Vud2VRK1d3L2Y2d3QyMGFCTFcKanhQSmZCZzQyeWd1dWQ2YkRjNFArUkpxaEVuTzB2ZkZYQkVuSFpaMmtmZzZCb1gzL3VpbEgvcTZtVkhLd0lPMQplTkVWaThhRmd6ZGl5WEk2b2Q0TEI2TGpnZzBZOUNZZ0ZBMFMwMUt2NkUwd0hjdzJSN3BHcCtlMEc5clRRSHNGCitVZFIxNDY2bEwxcEFwY1hLVk9HdjVtOGJtR1RyeWI0OFo0d245Uk9KREVmc3ozUmZRS0NBUUVBMHNWa3ZudU4KT0FwQnlJS2ZnUG96Rkt3b2ZaZWlkbXVjbmJkTktoQlVHbng0VnI5QzE3dkFuSmR4cFRoMHpCTkg4a1oxR1NISwpteTBRTEhRQlB1RE9oUmo3cjRQR0xXM1BGZ2tTTVJjSUJ4Yjl1Z3pUb1NBMitzekd6YzYvRWhCdzR5VzNySG5DCjNIdEY4U3hpeWZIK25Uc1RlZU1vWjRhaDVFeS8yZkt4UzZDbXNCYnJ2WjRVTEhxTEsvNzk4MVVFZDJIRWpZZzMKUGdqeXo5T1FjTCtKOVc4Nm9oWm9MY0UyRmtHcjJFNjZvZHY4d1p5Rnd0aytxVllYeWx2K1ljS0F4Ym43bXU5eQpQMWhFNm9ydTM2bk5QYTlob29Yc3RWSHh5ek1jTDFsNHZCRlJscUMzV3dlYk5NRWVuNFVGM3gwdkFHdE5XdFZRCkpRNEtGZ2ltdXBHWWx3S0NBUUJJbWx4Z0hkQUFVRTZtaXZIQVNrd3dlMEwxR3ZVLzdpRGI2T3J0cCtTSnRIMjYKUE9vYzRTWGliV2Y1Q2JLZ2lFSExocFdPYzR6K1JhZGZHakdKODBUMGhMRlI1Z2F0TmpQVVdXZmJHTTVUeXBXMQpkdll4MkpKOFB5YkQwWFcyU0FCM3NUc2YzNjZRV3Bza2hXMG9SVlg5aGN6bEY4NXBHREFFWWdOVlAydDBDejhwCkVJUkRRb3ErVjJ2THhPL3RtZzF4RjFpY0VMdlJpVStONmdxdUVndFMxNHYwMVVsUHc0eXNFVHgyUW4zRVV6SS8KUkQrU21Kb2pURHF4R1FSdlhwNXJCaXE3aElBNkl0Nnh1c25IcFVTVE5PNUpHMTFYeStPUkkzSWlZRHhRZUN5TApXWG1nZTI0bFFNc3pKTFZFdHhMYzJVazBnMkFDYUd5RWREdjFMUzZoQW9JQkFRQ3U5Q3NyOG1MR29iejVNM1F6CkczeExMSnh2bys2M1had2pUb1ErNWs3cHJXZzJtWXhpaHZiYkJOclF5b3dvMmRoZXd4MXdQeHh1c25rNmJSQ2IKb1AvTWUzQnZ3SEpBUTJZaVpHVTFXbWpQZWNZaktZS0J2THZtY3hTU3dZclk4OHpBd0E0Mm5OdWpLTEJtQVBILwpyMkFxSTErSFRZZThaNFQ2ZkxyRHJ6QjhGbDVHekwvaUpkV1pGaDl2NWJubXdpdHk3VFM2UnRlVUp0bG1xYmE3CjRFSWorTEF5MjJhZWxFTFJOckh1VzJ1UDc0dGZLdzNkTDNkVUdLS20xclhSY0NKei9tMWJybWFuTGg0R2treTIKVzd5Qjk1S1QxWmNtNjE1SnphTVhxcTBOYjFMS05aMzljZExqZDJwei8zZGdQRmxIZjhvMkc5cnE1eng0RGJaWQpKNE1CQW9JQkFDODhmRlI3SzVMcXVCV04wUElGWHFtdnFQV0tpdk0zdUliUkh5bXpoVHlScmM0S0tQbFdBa25sCmY5OXpUSTg2UCtZRTFGUTA0VTdmS3RHNEhtNkNJeHNOVG5CNWtWVDZJaTY2cHJ5Zkt5M2pYaG5qV1Y3ZTdpa3oKZzZOd1V6SmNveEFZVU9RWW85V1BvSHN0M094aE05N0NoSUdGa0tLT0xaelh2NnJWeG5majJXWWdhakRCVTFNQwpDQjhFVnBlbHBNOUNvdjdqY2NhRXdOcmg2cVE3MDl6MzdaOXh4WFlYT1hrUTB5TXFGM1NTMlhmZ2dFVWcvSDB3CndFa0xaN3NwYTNDZ01xREp2S09lbjJoeTM1S0txbkc1Tm0zSUdIVmdMeGZYWUlCcGZIalFPWmNwRTNDQllKSkQKSGp6Zk5HSGtySG81blA2RzNpOXRaNWZOV1BvUGFqcz0KLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLQo=
kind: Secret
metadata:
  labels:
    app: timescaledb-timescaledb
    cluster-name: timescaledb
  name: timescaledb-certificate
  namespace: ${kubernetes_namespace.thor.id}
type: kubernetes.io/tls
---
apiVersion: v1
data:
  PATRONI_REPLICATION_PASSWORD: bmsxWEdrUWxTdGU4cVJmQ3UzNTZFRUg0OVRMdGFaT0g=
  PATRONI_SUPERUSER_PASSWORD: U0JSWm0xQnFRRDVCT2t2QWtYSlV2UVhGTW12ek81R0k=
  PATRONI_admin_PASSWORD: M2VvSkplUU1iWjVnV3BHNDVWTjBCdGJpUFlVQzI0ckE=
kind: Secret
metadata:
  labels:
    app: timescaledb-timescaledb
    cluster-name: timescaledb
  name: timescaledb-credentials
  namespace: ${kubernetes_namespace.thor.id}
type: Opaque
---
apiVersion: v1
kind: Secret
metadata:
  labels:
    app: timescaledb-timescaledb
    cluster-name: timescaledb
  name: timescaledb-pgbackrest
  namespace: ${kubernetes_namespace.thor.id}
type: Opaque
YAML
}

resource "helm_release" "timescale" {
  name       = "timescale"
  repository = "https://charts.timescale.com"
  chart      = "timescaledb-single"
  version    = "0.5.5"
  namespace  = kubernetes_namespace.thor.id
}